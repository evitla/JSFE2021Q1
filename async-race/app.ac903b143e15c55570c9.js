(()=>{"use strict";var e={85:(e,t,n)=>{n.r(t)},7:(e,t,n)=>{n.r(t)},158:(e,t,n)=>{n.r(t)},169:(e,t,n)=>{n.r(t)},868:(e,t,n)=>{n.r(t)},583:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0,t.BaseComponent=class{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}}},113:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0,n(85),t.Button=class{constructor(e,t=[],n=!1){this.element=document.createElement("button"),this.element.classList.add("btn");const i=document.createElement("span");i.classList.add("front"),i.textContent=e,this.element.appendChild(i),this.element.disabled=n,this.element.classList.add(...t)}}},881:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Car=void 0,n(7);const s=n(583),r=n(113),o=n(842);class a extends s.BaseComponent{constructor(e,t=""){super("div",["car"]),this.engine=t,this.track=document.createElement("div"),this.selectButton=new r.Button("select",["secondary-btn","select-btn"]),this.removeButton=new r.Button("remove",["secondary-btn","remove-btn"]),this.startEngineButton=new r.Button("A",["start-engine-btn"]),this.stopEngineButton=new r.Button("B",["stop-engine-btn"],!0),this.name=document.createElement("span"),this.controlPanel=document.createElement("div"),this.carModel=e}render(){this.id=this.carModel.id,this.track.className="track",this.name.className="car-model",this.renderGeneralButtons(),this.renderName(this.carModel.name),this.track.appendChild(this.name),this.renderRoad(),this.renderImage(this.carModel.color),this.startEngineButton.element.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){yield this.startDriving()})))),this.stopEngineButton.element.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){yield this.stopDriving()}))))}startDriving(){return i(this,void 0,void 0,(function*(){this.startEngineButton.element.disabled=!0,this.stopEngineButton.element.disabled=!1;const{velocity:e,distance:t}=yield this.startEngine(),n=Math.round(t/e),i=this.track.getBoundingClientRect().width-this.controlPanel.getBoundingClientRect().width-100;this.animationState=o.animation(this.element,i,n);const{success:s}=yield this.drive();return s||window.cancelAnimationFrame(this.animationState.id),{success:s,id:this.id,time:n}}))}stopDriving(){return i(this,void 0,void 0,(function*(){this.startEngineButton.element.disabled=!1,this.stopEngineButton.element.disabled=!0,yield this.stopEngine(),this.element.style.transform="translate(0, 4px)",this.animationState&&window.cancelAnimationFrame(this.animationState.id)}))}startEngine(){return i(this,void 0,void 0,(function*(){return(yield fetch(`${this.engine}/?id=${this.id}&status=started`)).json()}))}stopEngine(){return i(this,void 0,void 0,(function*(){return(yield fetch(`${this.engine}/?id=${this.id}&status=stopped`)).json()}))}drive(){return i(this,void 0,void 0,(function*(){const e=yield fetch(`${this.engine}?id=${this.id}&status=drive`).catch();return 200!==e.status?{success:!1}:Object.assign({},yield e.json())}))}renderGeneralButtons(){const e=document.createElement("div");e.className="general-buttons",e.appendChild(this.selectButton.element),e.appendChild(this.removeButton.element),this.track.appendChild(e)}renderName(e){this.name.innerText=e}renderControlPanel(e){this.controlPanel.className="control-panel",this.controlPanel.appendChild(this.startEngineButton.element),this.controlPanel.appendChild(this.stopEngineButton.element),e.appendChild(this.controlPanel)}renderRoad(){const e=document.createElement("div");e.className="road",this.renderControlPanel(e),e.appendChild(this.element),this.track.appendChild(e)}renderImage(e){const t=`\n      <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n      <svg viewBox="0 0 720 720" preserveAspectRatio="xMidYMin slice"\n          xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://web.resource.org/cc/"\n          xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg"\n          xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n          xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="100" height="42"\n          version="1.0">\n        <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-8.835034,-24.54683)">\n          <path style="opacity:1;fill:white;fill-opacity:1;fill-rule:evenodd;stroke:black;stroke-width:9;stroke-linecap:butt;\n              stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 671.5397,119.6479\n              C 671.5397,119.6479 673.01697,164.47611 673.01697,164.47611 C 673.01697,164.47611 644.57046,162.12641\n              644.57046,162.12641 C 644.57046,162.12641 645.04333,105.92598 645.04333,105.92598 C 645.04333,105.92598\n              671.5397,119.6479 671.5397,119.6479 z " id="path30398" sodipodi:nodetypes="ccccc"/>\n          <path style="fill:${e};fill-opacity:1;fill-rule:evenodd;stroke:black;stroke-width:9;stroke-linecap:butt;\n              stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 404.28571,130.21932\n              L 427.14286,107.00503 L 642.14286,107.00503 L 642.85714,221.64789 L 402.5,218.4336 L 404.28571,130.21932 z"\n              id="path17112"/>\n          <path style="fill:black;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;\n              stroke-linejoin:miter;stroke-opacity:1" d="M 227.48737,231.7993 L 555.78695,231.7993 C 558.55188,209.27715\n              566.25616,187.77291 585.08137,173.21045 C 585.08137,173.21045 603.51666,155.53278 625.48748,149.97694\n              C 647.4583,144.4211 672.96465,150.98709 672.96465,150.98709 C 672.96465,150.98709 683.31871,160.331\n              684.07632,171.19014 C 684.83393,182.04928 675.9951,194.42365 675.9951,194.42365 C 675.9951,194.42365\n              612.3555,239.37544 578.01031,259.07342 C 543.66513,278.7714 538.61436,273.21555 538.61436,273.21555\n              L 242.63966,275.23586 C 242.63966,275.23586 223.6993,265.63941 217.38585,256.04296 C 211.0724,246.44651\n              214.86047,242.91097 217.38585,236.85006 C 219.91123,230.78915 227.48737,231.7993 227.48737,231.7993 z"\n              id="path6394" sodipodi:nodetypes="cccscscsccssc"/>\n          <g id="g5485" style="stroke:black;stroke-opacity:1" transform="translate(-20,-252.8572)">\n            <path transform="translate(2.020305,8.081222)" d="M 223.24371 488.69705 A 53.538086 53.538086 0 1 1\n                116.16754,488.69705 A 53.538086 53.538086 0 1 1  223.24371 488.69705 z" sodipodi:ry="53.538086"\n                sodipodi:rx="53.538086" sodipodi:cy="488.69705" sodipodi:cx="169.70563" style="fill:white;\n                fill-opacity:1;stroke:black;stroke-width:30;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n                sodipodi:type="arc"/>\n            <path transform="translate(2.020305,2.020305)" d="M 179.80715 495.26306 A 11.616755 12.626906 0 1 1\n                156.57364,495.26306 A 11.616755 12.626906 0 1 1  179.80715 495.26306 z" sodipodi:ry="12.626906"\n                sodipodi:rx="11.616755" sodipodi:cy="495.26306" sodipodi:cx="168.1904" style="fill:none;\n                fill-opacity:1;stroke:black;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n                sodipodi:type="arc"/>\n          </g>\n          <g id="g5489" transform="translate(482.0458,-246.7962)" style="stroke:black;stroke-opacity:1">\n            <path transform="translate(2.020305,8.081222)" d="M 223.24371 488.69705 A 53.538086 53.538086 0 1 1\n                116.16754,488.69705 A 53.538086 53.538086 0 1 1  223.24371 488.69705 z" sodipodi:ry="53.538086"\n                sodipodi:rx="53.538086" sodipodi:cy="488.69705" sodipodi:cx="169.70563" style="fill:white;\n                fill-opacity:1;stroke:black;stroke-width:30;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n                sodipodi:type="arc"/>\n            <path transform="translate(2.020305,2.020305)" d="M 179.80715 495.26306 A 11.616755 12.626906 0 1 1\n                156.57364,495.26306 A 11.616755 12.626906 0 1 1  179.80715 495.26306 z" sodipodi:ry="12.626906"\n                sodipodi:rx="11.616755" sodipodi:cy="495.26306" sodipodi:cx="168.1904" style="fill:none;\n                fill-opacity:1;stroke:black;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n                sodipodi:type="arc"/>\n          </g>\n          <g id="g5495" transform="translate(314.3605,-299.3242)" style="stroke:black;stroke-opacity:1">\n            <path transform="translate(2.020305,8.081222)" d="M 223.24371 488.69705 A 53.538086 53.538086 0 1 1\n                116.16754,488.69705 A 53.538086 53.538086 0 1 1  223.24371 488.69705 z" sodipodi:ry="53.538086"\n                sodipodi:rx="53.538086" sodipodi:cy="488.69705" sodipodi:cx="169.70563" style="fill:white;\n                fill-opacity:1;stroke:black;stroke-width:30;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n                sodipodi:type="arc"/>\n            <path transform="translate(2.020305,2.020305)" d="M 179.80715 495.26306 A 11.616755 12.626906 0 1 1\n                156.57364,495.26306 A 11.616755 12.626906 0 1 1  179.80715 495.26306 z" sodipodi:ry="12.626906"\n                sodipodi:rx="11.616755" sodipodi:cy="495.26306" sodipodi:cx="168.1904" style="fill:none;\n                fill-opacity:1;stroke:black;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n                sodipodi:type="arc"/>\n          </g>\n          <path style="fill:none;fill-rule:evenodd;stroke:black;stroke-width:9;stroke-linecap:butt;stroke-linejoin:miter;\n              stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 14.850263,237.35514 C 15.18698,237.35514\n              15.523698,237.35514 15.860415,237.35514 C 24.271408,237.35514 30.562089,234.37915 33.033009,236.85006\n              C 34.557562,238.37462 29.956611,239.9724 28.992398,241.90083 C 27.617783,244.65006 26.810309,248.23138\n              25.456865,250.48712 C 24.129772,252.69894 25.123715,255.88174 25.961941,257.55819 C 27.579645,260.7936\n              27.928267,262.55498 30.507627,265.13434 C 33.177358,267.80407 41.502601,270.28219 45.154839,271.19525\n              C 48.107953,271.93353 50.46675,272.52323 53.23606,273.21556 C 55.454804,273.77024 61.43235,271.47019\n              62.327432,269.68002 C 64.28812,265.75865 65.470235,267.71542 66.873119,262.10388 C 67.041478,261.43044\n              67.209836,260.75701 67.378195,260.08357 C 68.189739,256.8374 69.903577,254.42999 69.903577,250.9922\n              C 69.903577,248.40529 70.324432,244.76309 70.913729,242.4059 C 72.380904,236.5372 70.221772,229.64768\n              72.934034,224.22316 C 74.317633,221.45596 73.702041,215.59529 74.449263,212.6064 C 75.138725,209.84855\n              76.547939,207.3989 77.984797,204.52518 C 79.58811,201.31856 81.93448,198.32291 82.53048,195.93889 C 83.24447,\n              193.08294 84.55079,190.42891 84.55079,187.35259 C 84.55079,183.31198 84.55079,179.27137 84.55079,175.23076\n              C 84.55079,172.10413 82.79412,168.20409 82.02541,165.12923 C 81.15535,161.64901 81.35179,160.07847\n              77.479721,160.07847 C 73.911839,160.07847 70.165639,159.06832 66.368043,159.06832 C 61.166963,159.06832\n              55.080575,158.35465 50.205602,159.57339 C 46.881905,160.40432 41.36367,158.91742 38.083771,159.57339\n              C 35.276152,160.13492 32.123776,159.4219 29.497475,160.07847 C 25.93936,160.968 26.39822,160.95103 27.982246,\n              164.11908 C 29.109171,166.37293 29.497475,169.15959 29.497475,171.69523 C 29.497475,174.71613 28.992398,\n              177.48962 28.992398,180.28152 C 28.992398,183.84028 27.982246,187.3919 27.982246,190.88812 C 27.982246,\n              193.91858 27.982246,196.94904 27.982246,199.9795 C 27.982246,203.86009 27.526737,205.05504 24.446712,203.51503\n              C 21.780351,202.18185 20.048446,202.52058 17.375644,204.52518 C 14.503397,206.67937 13.335034,206.49358\n              13.335034,210.5861 C 13.335034,213.48425 13.553941,215.5696 14.345187,217.15209 C 14.785652,218.03302 18.75701,\n              219.03853 19.395949,219.67747 C 20.246756,220.52828 20.192844,222.86505 20.406102,223.71808"/>\n          <path style="fill:black;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1.12169349px;stroke-linecap:butt;\n              stroke-linejoin:miter;stroke-opacity:1" d="M 43.957903,171.251 C 43.957903,173.75711 43.957903,179.78453\n              43.957903,183.94851 C 43.957903,187.65197 43.957903,191.35541 43.957903,195.05885 C 43.957903,198.17018\n              44.564576,202.16931 44.564576,205.64011 C 44.564576,209.10238 33.715627,215.03965 32.541435,217.08761\n              C 30.028641,221.47028 35.134181,221.41319 31.624156,225.23944 C 29.815406,227.21115 39.548148,226.20248\n              42.137884,227.33171 C 43.875003,228.08915 42.137884,234.76846 42.137884,236.32578 C 42.137884,240.25426\n              40.924538,243.55429 40.924538,247.4361 C 40.924538,251.26425 40.752634,252.04777 43.35123,254.31393\n              C 45.983718,256.60965 46.394284,258.27979 50.024634,257.48831 C 51.41808,257.18452 55.717092,256.07322\n              55.986861,255.1322 C 56.838931,252.15991 53.581091,244.09711 54.271346,241.08735 C 54.95314,238.11448\n              55.445326,235.86537 56.698039,233.68047 C 58.539307,230.46902 60.63805,225.75625 61.551423,222.57014\n              C 62.442877,219.46049 63.822234,216.90108 64.584788,213.57606 C 65.179671,210.98216 65.798135,207.21304\n              65.798135,204.05292 C 65.798135,201.21014 66.231697,196.72084 67.011482,194.00072 C 68.126263,190.11203\n              67.618154,185.40713 67.618154,181.3032 C 67.618154,178.30148 67.921149,176.01317 68.8315,174.42538 C 69.088535,\n              173.97707 61.557444,172.83818 60.94475,172.83818 C 58.139863,172.83818 54.578869,171.78007 51.23798,171.78007\n              C 48.645693,171.78007 46.557782,171.70446 43.957903,171.251 z" sodipodi:nodetypes="csssssssssssssssssssssc"/>\n          <path style="fill:none;fill-rule:evenodd;stroke:black;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;\n              stroke-opacity:1" d="M 231.52798,217.15209 C 231.52798,217.32045 231.52798,217.48881 231.52798,217.15209 z"/>\n          <path style="fill:none;fill-rule:evenodd;stroke:black;stroke-width:11;stroke-linecap:butt;stroke-linejoin:miter;\n              stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 83.79317,194.17111 C 113.87209,161.04787\n              152.08605,148.86677 191.61805,171.18169 C 204.14683,182.44342 222.75306,199.22592 231.02292,213.61656\n              C 231.02292,213.61656 231.52798,218.16224 231.52798,218.16224 C 231.52798,218.16224 422.95189,218.41478\n              422.95189,218.41478" sodipodi:nodetypes="ccccc"/>\n          <path style="fill:${e};fill-opacity:1;fill-rule:evenodd;stroke:black;stroke-width:9;stroke-linecap:butt;\n              stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 151.07143,155.57646\n              C 152.5982,154.45902 154.68309,151.0116 155.71429,148.4336 C 166.65085,131.86309 207.04265,128.46644 225,\n              127.00503 C 229.46381,126.01307 234.30636,123.05582 237.5,119.86217 C 241.50946,115.639 238.55432,115.37931\n              243.21429,118.07646 C 245.14622,120.0084 248.30358,127.03479 251.42857,128.07646 C 260.14745,131.41836\n              268.05058,129.56036 276.78571,129.86217 C 276.78571,129.86217 312.5,129.50504 312.5,129.50504 C 312.5,129.50504\n              313.57143,218.79075 313.57143,218.79075 C 290.21711,212.25127 252.72804,224.24341 231.07143,218.43361\n              C 223.17289,183.44373 166.43499,156.02045 149.64286,160.57646 C 150.01475,159.08891 150.71037,158.08429\n              151.07143,157.36217" sodipodi:nodetypes="cccccccccccc"/>\n          <path style="fill:black;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;\n              stroke-linejoin:miter;stroke-opacity:1" d="M 239.28572,135.57646 C 239.28572,135.57646 241.60714,90.130037\n              239.64285,69.147897 C 237.67857,48.165757 230.29598,43.450977 232.85714,33.076467 C 235.02014,24.314787\n              343.48215,26.915747 389.64286,32.719327 C 389.64286,32.719327 399.91071,39.058607 416.07143,43.433607\n              C 432.23215,47.808607 453.57143,48.790757 453.57143,48.790757 L 449.82461,53.368437 C 461.07143,50.219327\n              418.29374,54.106697 417.85714,58.790757 C 417.38224,63.885747 428.21429,111.64789 428.21429,111.64789\n              L 411.78571,131.64789 C 411.78571,131.64789 406.07143,131.38003 398.57143,126.64789 C 391.07143,121.91575\n              381.78571,112.71932 381.78571,112.71932 L 363.21429,126.29075 C 363.21429,126.29075 351.51785,131.46932\n              359.28571,120.21932 C 367.05356,108.96932 384.10714,89.415757 394.28571,81.290757 C 404.46428,73.165757 400,\n              87.719327 400,87.719327 L 387.14286,107.00503 C 387.14286,107.00503 403.74313,123.82169 411.42857,121.64789\n              C 415.91891,120.37781 417.91633,109.61197 418.92857,110.21932 L 402.5,55.219327 L 331.42857,48.433607\n              L 277.14286,55.933607 L 311.42857,119.14789 L 313.21429,130.9336 L 239.28572,135.57646 z"\n              sodipodi:nodetypes="cssssccsccsccssccsccccccc"/>\n          <rect style="fill:${e};fill-opacity:1;stroke:black;stroke-width:9;stroke-miterlimit:4;stroke-dasharray:none;\n              stroke-opacity:1"  width="90.910027" height="88.410027" x="312.93784" y="129.94287"/>\n          <path style="fill:none;fill-rule:evenodd;stroke:black;stroke-width:9;stroke-linecap:butt;stroke-linejoin:miter;\n              stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 642.15499,107.55054 C 642.15499,107.55054\n              642.66007,76.740897 642.66007,76.740897" sodipodi:nodetypes="cc"/>\n        </g>\n      </svg>\n    `;return this.element.innerHTML=t,t}}t.Car=a},842:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.animation=void 0,t.animation=function(e,t,n){let i=null;const s={id:null};return s.id=window.requestAnimationFrame((function r(o){i||(i=o);const a=o-i,d=Math.round(a*t/n);e.style.transform=`translate(${Math.min(d,t)}px, 4px)`,d<t&&(s.id=window.requestAnimationFrame(r))})),s}},323:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CarForm=void 0;const i=n(113),s=n(697),r=n(69);class o extends s.Form{constructor(e,t=!1){super(["form"]),this.render(e,t)}listen(){return new Promise((e=>{this.submitButton.element.addEventListener("click",(t=>{const n=this.getData(t);e(n),this.clear()}),{once:!0})}))}clear(){this.modelInput.element.value="",this.colorInput.element.value="#ffffff"}changeDisabling(e){this.modelInput.element.disabled=e,this.colorInput.element.disabled=e,this.submitButton.element.disabled=e}render(e,t){this.modelInput=new r.Input({type:"text",id:`${e}-model`,name:"model",isDisabled:t},["text-input"]),this.colorInput=new r.Input({type:"color",id:`${e}-color`,name:"color",value:"#ffffff",isDisabled:t},["color-input"]),this.submitButton=new i.Button(e,["btn","primary-btn"],t),this.submitButton.element.type="submit",this.element.appendChild(this.modelInput.element),this.element.appendChild(this.colorInput.element),this.element.appendChild(this.submitButton.element)}}t.CarForm=o},697:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Form=void 0,t.Form=class{constructor(e=[]){this.data=null,this.element=document.createElement("form"),this.element.classList.add(...e)}getData(e){e.preventDefault();const t=new FormData(this.element);return this.data={name:`${t.get("model")}`,color:`${t.get("color")}`},this.data}}},766:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GarageController=void 0,n(158);const s=n(583),r=n(323),o=n(113),a=i(n(308));class d extends s.BaseComponent{constructor(e){super("div",["garage-controller"]),this.carFormToCreate=new r.CarForm("create"),this.carFormToUpdate=new r.CarForm("update",!0),this.startRaceButton=new o.Button("Start",["btn","primary-btn"]),this.resetRaceButton=new o.Button("Reset",["btn","primary-btn"],!0),this.generateCarsButton=new o.Button("Generate cars",["btn","secondary-btn"]),this.title=document.createElement("h1"),this.pageTitle=document.createElement("h2"),e.appendChild(this.element)}render(){const e=document.createElement("div");e.className="garage-controller__buttons",this.element.appendChild(this.carFormToCreate.element),this.element.appendChild(this.carFormToUpdate.element),e.appendChild(this.startRaceButton.element),e.appendChild(this.resetRaceButton.element),e.appendChild(this.generateCarsButton.element),this.element.appendChild(e),this.element.appendChild(this.title),this.element.appendChild(this.pageTitle)}renderTitle(e){this.title.innerText=`Race(${e})`,this.pageTitle.innerText=`Page ${a.default.carsPage}`}}t.GarageController=d},785:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Garage=void 0;const r=n(583),o=n(881),a=s(n(308)),d=n(513),l=n(680);class c extends r.BaseComponent{constructor(e,t,n,s){super("div",["garage"]),this.url=t,this.garageController=n,this.pagination=s,this.cars=[],this.getCar=e=>i(this,void 0,void 0,(function*(){return(yield fetch(`${this.url.garage}/${e}`)).json()})),this.listen(),e.appendChild(this.element)}listen(){this.garageController.carFormToCreate.submitButton.element.addEventListener("click",(e=>i(this,void 0,void 0,(function*(){const t=this.garageController.carFormToCreate.getData(e);yield this.createCar(t),yield this.render(),this.garageController.carFormToCreate.clear()})))),this.garageController.generateCarsButton.element.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){const e=d.generateRandomCars(100);yield Promise.all(e.map((e=>this.createCar(e)))),yield this.render()})))),this.pagination.listen((()=>i(this,void 0,void 0,(function*(){this.element.innerHTML="",yield this.render()}))),!0)}startRace(e){return i(this,void 0,void 0,(function*(){const t=this.cars.map((e=>e.startDriving())),n=yield this.raceAll(t,e.map((e=>e.id))),i=d.renderMessage(n.car.carModel.name,n.time);return this.element.appendChild(i),yield l.delay(3e3),this.element.removeChild(i),n}))}raceAll(e,t){return i(this,void 0,void 0,(function*(){const{success:n,id:i,time:s}=yield Promise.race(e);if(!n){const n=t.findIndex((e=>e===i)),s=[...e.slice(0,n),...e.slice(n+1,e.length)],r=[...t.slice(0,n),...t.slice(n+1,t.length)];return this.raceAll(s,r)}return{car:this.cars.find((e=>e.id===i)),time:(s/1e3).toFixed(2)}}))}createCar(e){return i(this,void 0,void 0,(function*(){return(yield fetch(this.url.garage,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json()}))}removeCar(e){return i(this,void 0,void 0,(function*(){const t=(yield fetch(`${this.url.garage}/${e.id}`,{method:"DELETE"})).json();return yield this.render(),t}))}updateCar(e,t){return i(this,void 0,void 0,(function*(){return e.renderName(t.name),e.renderImage(t.color),(yield fetch(`${this.url.garage}/${e.id}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json()}))}render(){return i(this,void 0,void 0,(function*(){this.element.innerHTML="",this.cars=[];const e=yield this.getCars(a.default.carsPage,a.default.carsPerPage);this.count=+e.count,this.garageController.renderTitle(this.count),e.models.forEach((e=>this.renderCar(e))),this.pagination.updateState(a.default.carsPage,a.default.carsPerPage,this.count)}))}getCars(e,t){return i(this,void 0,void 0,(function*(){const n=yield fetch(`${this.url.garage}?_page=${e}&_limit=${t}`);return{models:yield n.json(),count:n.headers.get("X-Total-Count")}}))}deleteWinner(e){return i(this,void 0,void 0,(function*(){(yield fetch(`${this.url.winners}/${e}`,{method:"DELETE"})).json()}))}renderCar(e){const t=new o.Car(e,this.url.engine);t.render(),this.cars.push(t),t.selectButton.element.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){t.removeButton.element.disabled=!0,this.garageController.carFormToUpdate.changeDisabling(!1);const e=yield this.garageController.carFormToUpdate.listen();yield this.updateCar(t,e),t.removeButton.element.disabled=!1,this.garageController.carFormToUpdate.changeDisabling(!0)})))),t.removeButton.element.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){yield this.removeCar(t),yield this.deleteWinner(t.id)})))),this.element.appendChild(t.track)}}t.Garage=c},513:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renderMessage=t.generateRandomCars=void 0;const n=["Tesla","Mercedes","BMW","Ferrari","Honda","Toyota","Ford","Volkswagen","Porsche","Bentley"],i=["Model S","Camry","CLK","Combi","Cayene","7 Series","9 Series","11 Series","DB9","Model E","X5"],s=()=>{let e="#";for(let t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e};t.generateRandomCars=(e=100)=>{const t=[];for(let r=0;r<e;r++)t.push({name:`${n[Math.floor(Math.random()*n.length)]} ${i[Math.floor(Math.random()*i.length)]}`,color:s()});return t},t.renderMessage=(e,t)=>{const n=document.createElement("div");return n.className="modal",n.innerHTML=`\n    <div class="modal-content">\n      The winner is ${e}. Time: ${t} seconds.\n    </div>\n  `,n}},977:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const i=n(583),s=n(113);class r extends i.BaseComponent{constructor(e){super("header",["header"]),this.raceButton=new s.Button("Race",["btn","primary-btn"]),this.winnersButton=new s.Button("Winners",["btn","primary-btn"]),e.appendChild(this.element)}render(){this.element.appendChild(this.raceButton.element),this.element.appendChild(this.winnersButton.element)}}t.Header=r},69:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0,t.Input=class{constructor(e,t=[]){this.element=document.createElement("input"),this.element.classList.add(...t),e.id&&(this.element.id=e.id),e.name&&(this.element.name=e.name),e.type&&(this.element.type=e.type),e.value&&(this.element.value=e.value),e.isDisabled&&(this.element.disabled=e.isDisabled)}}},295:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Pagination=void 0;const r=s(n(308)),o=n(583),a=n(113);class d extends o.BaseComponent{constructor(){super("div",["pagination"]),this.prevButton=new a.Button("prev",["btn","primary-btn"]),this.nextButton=new a.Button("next",["btn","primary-btn"]),this.element.appendChild(this.prevButton.element),this.element.appendChild(this.nextButton.element)}listen(e,t){return i(this,void 0,void 0,(function*(){this.nextButton.element.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){t?r.default.carsPage++:r.default.winnersPage++,e()})))),this.prevButton.element.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){t?r.default.carsPage--:r.default.winnersPage--,e()}))))}))}updateState(e,t,n){this.nextButton.element.disabled=!(e*t<n),this.prevButton.element.disabled=!(e>1)}}t.Pagination=d},910:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersTable=void 0,n(169);const i=n(583),s=n(881);class r extends i.BaseComponent{constructor(){super("table",["winners-table"]),this.winsHead=document.createElement("th"),this.bestTimeHead=document.createElement("th"),this.body=document.createElement("tbody"),this.winsHead.className="winners-table__wins",this.bestTimeHead.className="winners-table__time"}render(e,t){this.element.innerHTML="",this.renderHead(),this.renderBody(t),this.element.appendChild(this.body),e.appendChild(this.element)}renderHead(){const e=document.createElement("thead");["Number","Car","Name"].forEach((t=>{const n=document.createElement("th");n.textContent=t,e.appendChild(n)})),this.winsHead.textContent="Wins",this.bestTimeHead.textContent="Best time (seconds)",e.appendChild(this.winsHead),e.appendChild(this.bestTimeHead),this.element.appendChild(e)}renderBody(e){this.body.innerHTML="",e.items.forEach(((e,t)=>{const n=document.createElement("tr");n.innerHTML=`\n        <td>${t+1}</td>\n        <td>${new s.Car(e.car).renderImage(e.car.color)}</td>\n        <td>${e.car.name}</td>\n        <td>${e.wins}</td>\n        <td>${e.time}</td>\n      `,this.body.appendChild(n)}))}}t.WinnersTable=r},287:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Winners=void 0;const r=s(n(308)),o=n(583),a=n(910);class d extends o.BaseComponent{constructor(e,t,n){super("div",["winners"]),this.winnersURL=e,this.garage=t,this.pagination=n,this.table=new a.WinnersTable,this.pagination.listen((()=>i(this,void 0,void 0,(function*(){this.element.innerHTML="",yield this.render()}))),!1)}render(){return i(this,void 0,void 0,(function*(){this.element.innerHTML="";const e=yield this.getWinners(r.default.winnersPage,r.default.winnersPerPage,r.default.sortBy,r.default.sortOrder);this.count=+e.count,this.renderTitle(),this.table.render(this.element,e),this.pagination.updateState(r.default.winnersPage,r.default.winnersPerPage,this.count)}))}listen(){const e=e=>i(this,void 0,void 0,(function*(){r.default.sortBy=e,r.default.sortOrder="ASC"===r.default.sortOrder?"DESC":"ASC";const t=yield this.getWinners(r.default.winnersPage,r.default.winnersPerPage,r.default.sortBy,r.default.sortOrder);this.table.renderBody(t)}));this.table.winsHead.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){yield e("wins")})))),this.table.bestTimeHead.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){yield e("time")}))))}saveWinner(e,t){return i(this,void 0,void 0,(function*(){if(404===(yield this.getWinnerStatus(e)))return void(yield this.createWinner({id:e,wins:1,time:t}));const n=yield this.getWinner(e);yield this.updateWinner(e,{id:e,wins:n.wins+1,time:t<n.time?t:n.time})}))}getWinners(e,t,n,s){return i(this,void 0,void 0,(function*(){const r=n&&s?`&_sort=${n}&_order=${s}`:"",o=yield fetch(`${this.winnersURL}?_page=${e}&_limit=${t}${r}`),a=yield o.json();return{items:yield Promise.all(a.map((e=>i(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{car:yield this.garage.getCar(e.id)})}))))),count:+o.headers.get("X-Total-Count")}}))}getWinner(e){return i(this,void 0,void 0,(function*(){return(yield fetch(`${this.winnersURL}/${e}`)).json()}))}getWinnerStatus(e){return i(this,void 0,void 0,(function*(){return(yield fetch(`${this.winnersURL}/${e}`)).status}))}createWinner(e){return i(this,void 0,void 0,(function*(){return(yield fetch(this.winnersURL,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json()}))}updateWinner(e,t){return i(this,void 0,void 0,(function*(){return(yield fetch(`${this.winnersURL}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json()}))}renderTitle(){const e=document.createElement("h1"),t=document.createElement("h2");e.innerText=`Winners(${this.count})`,t.innerText=`Page ${r.default.winnersPage}`,this.element.appendChild(e),this.element.appendChild(t)}}t.Winners=d},607:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(868);const r=n(977),o=n(539),a=n(182),d=n(295),l=n(766),c=n(785),h=n(287),u=s(n(308)),m="http://localhost:3000",p=`${m}/winners`,f={garage:`${m}/garage`,engine:`${m}/engine`,winners:p},y=new r.Header(document.body),C=document.createElement("main"),v=new d.Pagination,g=new d.Pagination,k=new l.GarageController(C),b=new c.Garage(C,f,k,v),w=new h.Winners(p,b,g),B=[k.startRaceButton.element,k.generateCarsButton.element,v.nextButton.element,v.prevButton.element];k.startRaceButton.element.addEventListener("click",(()=>i(void 0,void 0,void 0,(function*(){k.carFormToCreate.changeDisabling(!0),B.forEach((e=>{e.disabled=!0})),k.resetRaceButton.element.disabled=!1;const e=yield b.startRace(b.cars);w.saveWinner(e.car.id,+e.time)})))),k.resetRaceButton.element.addEventListener("click",(()=>i(void 0,void 0,void 0,(function*(){k.resetRaceButton.element.disabled=!0,yield Promise.all(b.cars.map((e=>e.stopDriving()))),k.carFormToCreate.changeDisabling(!1),B.forEach((e=>{e.disabled=!1})),v.updateState(u.default.carsPage,u.default.carsPerPage,b.count)}))));const _=new o.GarageView(b,k,v),P=new a.WinnersView(w,g);y.render(),C.appendChild(_.element),C.appendChild(P.element),y.raceButton.element.addEventListener("click",(()=>{_.element.style.display="block",P.element.style.display="none"})),y.winnersButton.element.addEventListener("click",(()=>{w.render(),_.element.style.display="none",P.element.style.display="block"})),document.body.appendChild(C)},539:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageView=void 0,t.GarageView=class{constructor(e,t,n){this.element=document.createElement("div"),this.element.id="garage-view",t.render(),e.render(),this.element.appendChild(t.element),this.element.appendChild(e.element),this.element.appendChild(n.element)}}},182:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersView=void 0,t.WinnersView=class{constructor(e,t){this.element=document.createElement("div"),this.element.id="winners-view",this.element.style.display="none",e.listen(),this.element.appendChild(e.element),this.element.appendChild(t.element)}}},680:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise((t=>{setTimeout(t,e)}))}},308:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default={carsPage:1,carsPerPage:7,winnersPage:1,winnersPerPage:10,sortBy:null,sortOrder:null}}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();